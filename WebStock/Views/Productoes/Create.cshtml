@model WebStock.Models.Producto
 
@{
    ViewData["Title"] = "Create";
    string fecha = Convert.ToString(DateTime.Now);
    string test = "nada";


    void BtnPrecioBulto_Click(Object sender, EventArgs e) =>
        // When the button is clicked,
        // change the button text, and disable it.

        test = "funciona";// Display the greeting label text.
}


<div class="flex-column h-auto p-2 mw-100 rounded-3 mt-5 mb-4 justify-content-center align-content-center" style="background-color:#262626">
    <div class="col d-flex justify-content-center align-items-center">
        <img src="~/img/DeleteTittle.png" width="500" height="110" />
    </div>
</div>

<div class="bg-white p-4 rounded-3">
    @**@
    <form asp-action="Create">
    <div asp-validation-summary="ModelOnly" class="text-danger"></div>
    <div class="mb-2">
        <div class="flex-column" style="margin-right:50px">
            <div class="col-8">
                <img src="/img/View (1).png" class="" height="64" width="499" alt="...">
            </div>
        </div>
    </div>
    @**@
    <div class="row row-cols-3 mw-100">
        <div class="col-4 mb-3">
            <div class="form-group">
                <label for="exampleInputEmail1" class="mb-2 fw-bold" style="font-family:'Lucida Sans'; margin-left:5px">Tipo de Producto</label>
                    <select asp-for="TipoProductoId" class="form-control form-select pe-auto" asp-items="ViewBag.TipoProductoId"></select>
            </div>
        </div>
        <div class="col-4 mb-3">
            <div class="form-group">
                <label for="exampleInputEmail1" class="mb-2 fw-bold" style="font-family:'Lucida Sans'; margin-left:5px">Marca</label>
                    <select asp-for="MarcaId" class="form-control form-select pe-auto" asp-items="ViewBag.MarcaId"></select>
            </div>
        </div>
        <div class="col-4 mb-3">
            <div class="form-group">
                <label for="exampleInputEmail1" class="mb-2 fw-bold" style="font-family:'Lucida Sans'; margin-left:5px">Detalles</label>
                <input asp-for="Detalles" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" placeholder="">
                <span asp-validation-for="Detalles" class="text-danger"></span>
            </div>
        </div>
        @**@
        <div class="col-4 mb-3">
            <div class="form-group">
                <label for="exampleInputEmail1" class="mb-2 fw-bold" style="font-family:'Lucida Sans'; margin-left:5px">Especificación</label>
                    <select asp-for="SPECId" class="form-control form-select pe-auto" asp-items="ViewBag.SPECId"></select>
             </div>
        </div>
        @**@
        <div class="col-4">
            @*            <div class="form-group">
            <label for="exampleInputEmail1" class="mb-1 fw-bold" style="font-family:'Lucida Sans'">Detalles</label>
            <input type="email" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" placeholder="@Html.DisplayFor(model => model.Detalles)" disabled>
            </div>
            *@
        </div>
        @**@
        <div class="col-4">
            @*            <div class="form-group">
            <label for="exampleInputEmail1" class="mb-1 fw-bold" style="font-family:'Lucida Sans'">Detalles</label>
            <input type="email" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" placeholder="@Html.DisplayFor(model => model.Detalles)" disabled>
            </div>
            *@
        </div>
    </div>
    <hr class="hr mb-3" />
        @**@
        <div class="mb-2">
            <div class="flex-column" style="margin-right:50px">
                <div class="col-8">
                    <img src="/img/UnidadTittle.png" class="" height="64" width="499" alt="...">
                </div>
            </div>
        </div>
        @**@
        <div class="row row-cols-3 mw-100">
            <div class="col-4" style="margin-top:3px">
                <div class="form-group">
                    <label class="mb-2 fw-bold" style="font-family:'Lucida Sans'; margin-left:5px">Ganancia</label>
                    <input asp-for="Ganancia" id="InputGanancia" value="30" class="form-control" disabled>
                    <span asp-validation-for="Ganancia" class="text-danger"></span>
                </div>
            </div>
            <div class="col-4" style="margin-top:3px">
                <div class="form-group">
                    <label class="mb-2 fw-bold" style="font-family:'Lucida Sans'; margin-left:5px">Precio Unidad</label>
                    <input asp-for="PrecioUnidad" id="InputPrecioUnidad" class="form-control">
                    <span asp-validation-for="PrecioUnidad" class="text-danger"></span>
                </div>
            </div>
            <div class="col-4 d-flex" >
                <div class="form-group">
                    <label class="mb-2 fw-bold" style="font-family:'Lucida Sans'; margin-left:5px">Precio de Venta</label>
                    <div class="d-flex">
                        <input asp-for="PVP" id="InputPVP" class="form-control">
                        <button type="button" onclick="CalcularPVP()" class="btn btn-primary p-2 px-3 mx-2">
                            <i class="bi bi-calculator fa-lg"></i>
                        </button>
                    </div>
                    <span asp-validation-for="PVP" class="text-danger"></span>
                </div>
            </div>
        </div>
        <hr class="hr mb-3" />
        @**@
        <div class="mb-2">
            <div class="flex-column" style="margin-right:50px">
                <div class="col-8">
                    <img src="/img/BultoTitlte.png" class="" height="64" width="499" alt="...">
                </div>
            </div>
        </div>
        @**@
        <div class="row row-cols-3 mw-100">
            <div class="col-4" style="margin-top:3px">
                <div class="form-group">
                    <label class="mb-2 fw-bold" style="font-family:'Lucida Sans'; margin-left:5px">Descuento</label>
                    <input asp-for="Descuento" value="8" id="InputDescuento" class="form-control" disabled>
                    <span asp-validation-for="Descuento" class="text-danger"></span>
                </div>
            </div>
            <div class="col-4" style="margin-top:3px">
                <div class="form-group">
                    <label class="mb-2 fw-bold" style="font-family:'Lucida Sans'; margin-left:5px">Cant. por Bulto</label>
                    <input asp-for="CantidadBulto" id="InputCantBulto"  class="form-control">
                    <span asp-validation-for="CantidadBulto" class="text-danger"></span>
                </div>
            </div>
            <div class="col-4 d-flex">
                <div class="form-group">
                    <label class="mb-2 fw-bold" style="font-family:'Lucida Sans'; margin-left:5px">Precio de Bulto</label>
                    <div class="d-flex">
                        <input asp-for="PrecioBulto" id="InputPrecioBulto" class="form-control">
                        <button type="button" id="BtnPrecioBulto" onclick="funcionJS()" class="btn btn-primary p-2 px-3 mx-2">
                            <i class="bi bi-calculator fa-lg"></i>
                        </button>
                    </div>
                    <span asp-validation-for="PrecioBulto" class="text-danger"></span>
                </div>
            </div>
        </div>
        <hr class="hr mb-3" />
        @**@
        <div class="mb-2">
            <div class="flex-column" style="margin-right:50px">
                <div class="col-8">
                    <img src="/img/OtrosTitlte.png" class="" height="64" width="499" alt="...">
                </div>
            </div>
        </div>
        @**@
        <div class="row row-cols-3 mw-100">
            <div class="col-4" style="margin-top:3px">
                <div class="form-group">
                    <label class="mb-2 fw-bold" style="font-family:'Lucida Sans'; margin-left:5px">Proveedor</label>
                    <select asp-for="ProveedorId" class="form-control form-select" asp-items="ViewBag.ProveedorId"></select>
                </div>
            </div>
            <div class="col-4" style="margin-top:3px">
                <div class="form-group">
                    <label class="mb-2 fw-bold" style="font-family:'Lucida Sans'; margin-left:5px">Stock</label>
                    <input asp-for="Stock" value="0" class="form-control">
                    <span asp-validation-for="Stock" class="text-danger"></span>
                </div>
            </div>
            <div class="col-4" style="margin-top:3px">
                <div class="form-group">
                    <label class="mb-2 fw-bold" style="font-family:'Lucida Sans'; margin-left:5px">Stock</label>
                    <input asp-for="Modificacion" value="@fecha" class="form-control">
                    <span asp-validation-for="Modificacion" class="text-danger"></span>
                </div>
            </div>
            <div class="col-4 mt-2" style="margin-top:3px">
                <div class="form-group">
                    <label class="mb-2 fw-bold" style="font-family:'Lucida Sans'; margin-left:5px">Usuario</label>
                    <select asp-for="UsuarioId" onclic item class="form-control" asp-items="ViewBag.UsuarioId"></select>
                </div>
            </div>
            <div class="col-4 mt-2" style="margin-top:3px">
                <div class="form-group">
                    <label class="mb-2 fw-bold" style="font-family:'Lucida Sans'; margin-left:5px">Visibilidad</label>
                    <input class="form-check-input" checked asp-for="Visible" /> @Html.DisplayNameFor(model => model.Visible)
                </div>
            </div>
            <div class="col-4 mt-2" style="margin-top:3px">
                <div class="form-group">
                    <label class="mb-2 fw-bold" style="font-family:'Lucida Sans'; margin-left:5px">Carrito</label>
                    <input asp-for="Carrito" class="form-control" value="0" disabled/>
                    <span asp-validation-for="Carrito" class="text-danger"></span>
                </div>
            </div>

        </div>
        <hr class="hr mb-3"/>
        @**@
        <div class="mb-2">
            <div class="flex-column" style="margin-right:50px">
                <div class="col-8">
                    <img src="/img/ImageTitlte.png" class="" height="64" width="499" alt="...">
                </div>
            </div>
        </div>
        @**@
        <div class="flex-column mw-100 mb-3">
            <div class="col-4 mb-3">
                <img src="/img/Caca (1).png" class="rounded-3 shadow" height="200" width="200" alt="...">
            </div>
            <div class="col d-flex mt-2 gap-5 mt-1">
                <button id="BtnSubir" onclick="importData()" class="btn btn-primary" type="button">
                    Subir
                </button>
                <button id="BtnByte" onclick="ByteArray()" class="btn btn-danger" type="button">
                    Eliminar 
                </button>
            </div>
        </div>
        <hr class="hr mb-3" />
        @**@
        <input type="submit" value="Create" class="btn btn-primary" />
    </form>

@*    <div class="row">
        <div class="col-md-4">
            <form asp-action="Create">
                <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                <div class="form-group">
                    <label asp-for="TipoProductoId" class="control-label"></label>
                    <select asp-for="TipoProductoId" class ="form-control form-select" asp-items="ViewBag.TipoProductoId"></select>
                </div>
                <div class="form-group">
                    <label asp-for="MarcaId" class="control-label"></label>
                    <select asp-for="MarcaId" class="form-control form-select" asp-items="ViewBag.MarcaId"></select>
                </div>
                <div class="form-group">
                    <label asp-for="Detalles" class="control-label"></label>
                    <input asp-for="Detalles" class="form-control" />
                    <span asp-validation-for="Detalles" class="text-danger"></span>
                </div>
                <div class="form-group">
                    <label asp-for="SPECId" class="control-label"></label>
                    <select asp-for="SPECId" class ="form-control" asp-items="ViewBag.SPECId"></select>
                </div>
                <div class="form-group">
                    <label asp-for="Descuento" class="control-label"></label>
                    <input asp-for="Descuento" class="form-control" />
                    <span asp-validation-for="Descuento" class="text-danger"></span>
                </div>
                <div class="form-group">
                    <label asp-for="PrecioBulto" class="control-label"></label>
                    <input asp-for="PrecioBulto" class="form-control" />
                    <span asp-validation-for="PrecioBulto" class="text-danger"></span>
                </div>
                <div class="form-group">
                    <label asp-for="CantidadBulto" class="control-label"></label>
                    <input asp-for="CantidadBulto" class="form-control" />
                    <span asp-validation-for="CantidadBulto" class="text-danger"></span>
                </div>
                <div class="form-group">
                    <label asp-for="PrecioUnidad" class="control-label"></label>
                    <input asp-for="PrecioUnidad" class="form-control" />
                    <span asp-validation-for="PrecioUnidad" class="text-danger"></span>
                </div>
                <div class="form-group">
                    <label asp-for="Ganancia" class="control-label"></label>
                    <input asp-for="Ganancia" class="form-control" />
                    <span asp-validation-for="Ganancia" class="text-danger"></span>
                </div>
                <div class="form-group">
                    <label asp-for="PVP" class="control-label"></label>
                    <input asp-for="PVP" class="form-control" />
                    <span asp-validation-for="PVP" class="text-danger"></span>
                </div>
                <div class="form-group">
                    <label asp-for="Stock" class="control-label"></label>
                    <input asp-for="Stock" class="form-control" />
                    <span asp-validation-for="Stock" class="text-danger"></span>
                </div>
                <div class="form-group">
                    <label asp-for="ProveedorId" class="control-label"></label>
                    <select asp-for="ProveedorId" class ="form-control" asp-items="ViewBag.ProveedorId"></select>
                </div>
                <div class="form-group">
                    <label asp-for="Imagen" class="control-label"></label>
                    <input asp-for="Imagen" id="InputImagen" class="form-control" />
                    <span asp-validation-for="Imagen" class="text-danger"></span>
                </div>
                <div class="form-group form-check">
                    <label class="form-check-label">
                        <input class="form-check-input" checked asp-for="Visible" /> @Html.DisplayNameFor(model => model.Visible)
                    </label>
                </div>
                <div class="form-group">
                    <label asp-for="Modificacion" class="control-label"></label>
                    <input asp-for="Modificacion" class="form-control" />
                    <span asp-validation-for="Modificacion" class="text-danger"></span>
                </div>
                <div class="form-group">
                    <label asp-for="UsuarioId" class="control-label"></label>
                    <select asp-for="UsuarioId" class ="form-control" asp-items="ViewBag.UsuarioId"></select>
                </div>
                <div class="form-group">
                    <label asp-for="Carrito" class="control-label"></label>
                    <input asp-for="Carrito" class="form-control" />
                    <span asp-validation-for="Carrito" class="text-danger"></span>
                </div>
                <div class="form-group">
                    <input type="submit" value="Create" class="btn btn-primary" />
                </div>

            </form>
        </div>
    </div>
*@

    <div>
        <a asp-action="Index">Back to List</a>
    </div>

    <pre id="result"></pre>
</div>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}

    <script>
        function CalcularPVP() {
            var ganancia = 0;
            var precioUnidad = 0;
            var PVP = 0;
             ganancia = $('#InputGanancia').val();
             precioUnidad = $('#InputPrecioUnidad').val();
            //
            if (precioUnidad < 1) {
                alert('Es necesario completar el campo Precio Unidad');
            }
            else {
                PVP = (Number(precioUnidad) + ((precioUnidad * ganancia) / 100));
                $('#InputPVP').val(PVP);
            }
        }

        function funcionJS() {
            var descuento = $('#InputDescuento').val();
            var precioUnidad = $('#InputPrecioUnidad').val();
            var cantidadBulto = $('#InputCantBulto').val();
            //
            var precioBulto = 0;
            //
            if (descuento < 1)
            {
                alert('Es necesario completar el campo Descuento');
            }
            else
            {
                if (precioUnidad < 1)
                {
                    alert('Es necesario completar el campo Precio Unidad');
                }
                else 
                {
                    if (cantidadBulto < 1)
                    {
                        alert('Es necesario completar el campo cantidad Bulto');
                    }
                    else
                    {
                        precioBulto = precioUnidad * cantidadBulto;
                        var precioPVPbulto = precioBulto - ((precioBulto * descuento) / 100);
                        $('#InputPrecioBulto').val(precioPVPbulto);
                    }
                }
            }
        }  
        //
        function importData() {
            ////Get file from your input element
            ////let myFile = document.createElement('BtnSubir').files[0];
            ////Wait for the file to be converted to a byteArray
            ////let byteArray = await fileToByteArray(myFile);

            ////Do something with the byteArray
            ////console.log(byteArray);
            let input = document.createElement('input');
            input.type = 'file';
            input.onchange = _ => {
                // you can use this method to get file and perform respective operations
                let files = String.from(input.files);
                //
                let utf8Encode = new TextEncoder();
                utf8Encode.encode(files);
                //
                $('#InputImagen').val(files);
                alert(files);
            };
            input.click();

        }
        //
        function ByteArray() {
            alert("Hola mundo");

            let files = $('#Image').attr('src', `data:image/png;base64,${yourByteArrayAsBase64}`);
            $('#InputImagen').val(files);
        }
        //
        function onImageChange(event) {
            const imageFile = URL.createObjectURL(event.target.files[0]);
            createImage(imageFile, convertImage);
        }

        function createImage(imageFile, callback) {
            const image = document.createElement("img");
            image.onload = () => callback(image);
            image.setAttribute("src", imageFile);
        }

        function convertImage(image) {
            const canvas = drawImageToCanvas(image);
            const ctx = canvas.getContext("2d");

            let result = [];
            for (let y = 0; y < canvas.height; y++) {
                result.push([]);
                for (let x = 0; x < canvas.width; x++) {
                    let data = ctx.getImageData(x, y, 1, 1).data;
                    result[y].push(data[0]);
                    result[y].push(data[1]);
                    result[y].push(data[2]);
                }
            }
            const byteArray = convertArray(result);
            $('#InputImagen').val(byteArray.replace(",", "="))

            const arrayCode = `
            #define IMAGE_WIDTH ${canvas.width}
            #define IMAGE_HEIGHT ${canvas.height}
            #define BYTES_PER_PIXEL 3
            uint8_t imageData[IMAGE_HEIGHT][IMAGE_WIDTH * BYTES_PER_PIXEL] = ${convertArray(
                result
            )};
          `;
            document.getElementById("result").innerHTML = arrayCode;
        }

        function drawImageToCanvas(image) {
            const canvas = document.createElement("canvas");
            canvas.width = image.width;
            canvas.height = image.height;
            canvas.getContext("2d").drawImage(image, 0, 0, image.width, image.height);
            return canvas;
        }

        function convertArray(array) {
            return JSON.stringify(array).replace(/\[/g, " ").replace(/\]/g, " ");
        }
    </script>
}
